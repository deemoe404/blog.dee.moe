<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>Compile Latest OpenCV on Ubuntu</title><meta name="description" content="眼见何事，情系何处，身在何方，心思何人"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.jpg"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="Compiling OpenCV can vary depending on the platform. In this demonstration, I will be using Ubuntu. However, these steps are mostly the same for any other distribution, with the only differences being the package manager and the package names.
Retrieve OpenCV source codeThis shell command retrieve the most recent OpenCV version number from the GitHub API a.."><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="deemoe's journal" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">deemoe's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Compile Latest OpenCV on Ubuntu</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/categories/Creation">Gallery</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/categories/Creation">Gallery</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Retrieve-OpenCV-source-code"><span class="toc-text">Retrieve OpenCV source code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-dependencies"><span class="toc-text">Install dependencies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Configure-CMake-project"><span class="toc-text">Configure CMake project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Compile"><span class="toc-text">Compile</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/OpenCV"><i class="tag post-item-tag">OpenCV</i></a><a href="/tags/Ubuntu"><i class="tag post-item-tag">Ubuntu</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Compile Latest OpenCV on Ubuntu</h1><time class="has-text-grey" datetime="2020-04-07T12:50:00.000Z">2020-04-07</time><article class="mt-2 post-content"><p>Compiling OpenCV can vary depending on the platform. In this demonstration, I will be using Ubuntu. However, these steps are mostly the same for any other distribution, with the only differences being the package manager and the package names.</p>
<h2 id="Retrieve-OpenCV-source-code"><a href="#Retrieve-OpenCV-source-code" class="headerlink" title="Retrieve OpenCV source code"></a>Retrieve OpenCV source code</h2><p>This shell command retrieve the most recent OpenCV version number from the GitHub API and store it in a shell variable for future use.</p>
<pre><code class="bash">vernum=$(wget -qO- -t1 -T2 "https://api.github.com/repos/opencv/opencv/releases/latest"  grep "tag_name"  head -n 1  awk -F ":" '{print $2}'  sed 's/\"//g;s/,//g;s/ //g;s/v//g')
</code></pre>
<p>Next, download and unzip the OpenCV source code from GitHub. To avoid cluttering the working directory, it’s recommended to create a new folder specifically for the compilation process.</p>
<pre><code class="bash">mkdir opencv_build &amp;&amp; cd opencv_build
</code></pre>
<pre><code class="bash">wget https://github.com/opencv/opencv/archive/refs/tags/$vernum.zip
unzip $vernum.zip &amp;&amp; rm $vernum.zip

wget https://github.com/opencv/opencv_contrib/archive/refs/tags/$vernum.zip
unzip $vernum.zip &amp;&amp; rm $vernum.zip

cd opencv-$vernum
</code></pre>
<h2 id="Install-dependencies"><a href="#Install-dependencies" class="headerlink" title="Install dependencies"></a>Install dependencies</h2><p>Before proceeding, make sure to update your system.</p>
<pre><code class="bash">sudo apt update &amp;&amp; sudo apt upgrade
</code></pre>
<p>The commands for installing the following packages include libraries that are commonly used with OpenCV, such as <strong>v4l</strong>, <strong>FFMPEG</strong>, and <strong>x264</strong>, but do not include GPU acceleration or machine learning components.</p>
<pre><code class="bash">sudo add-apt-repository "deb http://security.ubuntu.com/ubuntu xenial-security main"
sudo apt install -y build-essential cmake git unzip zip\
                pkg-config libavcodec-dev libavformat-dev libswscale-dev \
                libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev \
                libsnappy-dev libboost-all-dev libjasper-dev libdc1394-22-dev\
                python3-dev python3-numpy python3-pip ffmpeg libopenblas-dev \
                tesseract-ocr libtesseract-dev libprotobuf-dev libleveldb-dev \
                libhdf5-serial-dev protobuf-compiler libatlas-base-dev \
                libgflags-dev libgoogle-glog-dev liblmdb-dev libfaac-dev \
                gfortran libgstreamer1.0-dev libatlas-base-dev libxvidcore-dev \
                libpng-dev libopenexr-dev libwebp-dev \
                libmp3lame-dev libtheora-dev libvorbis-dev  \
                libopencore-amrwb-dev x264 v4l-utils libgdk-pixbuf2.0-dev \
                manpages-dev libopencore-amrnb-dev \
                libgstreamer-plugins-base1.0-dev libavresample-dev 
pip3 install --upgrade pip
apt-get install -f
</code></pre>
<h2 id="Configure-CMake-project"><a href="#Configure-CMake-project" class="headerlink" title="Configure CMake project"></a>Configure CMake project</h2><p>Remenber to execute all the build commands within a temporary directory. This way, if you make a mistake, you can easily delete the entire temporary folder to quickly start over.</p>
<pre><code class="bash">mkdir build &amp;&amp; cd build
</code></pre>
<p>To display a list of all CMake compile options, run the following command:</p>
<pre><code class="bash">cmake .. -LAH
</code></pre>
<ul>
<li>L List cached variables.</li>
<li>A Show options&nbsp;<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.0/command/mark_as_advanced.html">marked as advanced</a>.</li>
<li>H Show more helpful information about each option.</li>
</ul>
<p>Here’s an example configure command that you can use. If you’ve successfully installed the dependencies according to the previous instructions, this example cmake command should work for you.</p>
<pre><code class="bash">cmake -D CMAKE_BUILD_TYPE=RELEASE \
        -D CMAKE_INSTALL_PREFIX=/usr/local/ \
        -D OPENCV_ENABLE_NONFREE=ON \
        -D OPENCV_EXTRA_MODULES_PATH=~/opencv_build/opencv_contrib-$vernum/modules \
        -D OPENCV_GENERATE_PKGCONFIG=YES \
        -D WITH_QT=OFF \
        -D WITH_OPENGL=OFF \
        -D WITH_CUDA=OFF \
        -D BUILD_EXAMPLES=ON \
        -D INSTALL_PYTHON_EXAMPLES=ON \
        -D INSTALL_C_EXAMPLES=ON ..
</code></pre>
<p>If you find it overwhelming to deal with extensive text in the command line and have a GUI installed on your machine, consider trying tools like <strong><code>ccmake</code></strong> and <strong>cmake-gui</strong> for a more user-friendly experience.</p>
<blockquote>
<p>You can also check an existed OpenCV build what compile flags are used by a function built into OpenCV. In C++ it looks like this:</p>
<pre><code class="C++">cv::getBuildInformation()
</code></pre>
<p>In Python:</p>
<pre><code class="Python">cv2.getBuildInformation()
</code></pre>
</blockquote>
<h2 id="Compile"><a href="#Compile" class="headerlink" title="Compile"></a>Compile</h2><p>We’ve completed the necessary steps, and now it’s in the hands of your CPUs. The <strong>-j</strong> flag specifies how many threads will be used for compilation, and it should not exceed the number of CPU cores you have.</p>
<pre><code class="bash">make -j6
</code></pre>
<p>If the compilation process proceeds without errors, you can proceed with the installation by simply running this single line of code:</p>
<pre><code class="bash">make install
</code></pre>
<p>At this point, CMake should be able to detect the OpenCV library files.</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2021/06/16/Essay/windows11-and-frogy/" title="Windows 11 &amp; Forgy"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: Windows 11 &amp; Forgy</span></a><a class="button is-default" href="/1970/01/01/Writings/cat/" title="猫杂"><span class="has-text-weight-semibold">Next: 猫杂</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="deemoe404/dee.moe" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Mastodon--><a title="mastodon" target="_blank" rel="noopener nofollow" href="https://c7.io/@meow"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/deemoe404"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><a title="rss" target="_blank" rel="noopener nofollow" href="https://dee.moe/atom.xml"><i class="iconfont icon-rss"></i></a><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> deemoe 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script><!-- hexo injector body_end start --><script src="/js/outdate.js"></script><!-- hexo injector body_end end --></body></html>